{%extends "player_activities/base.html"%}
{% load gmap attachment_tags %}
{%block title%}Map Response Overview{%endblock%}

{%block main%}
    <h1>Open Response Overview</h1>
    <h2>{{activity.question|urlize}}</h2>
    
    <a style="float: right" id="my_comment" href="#">Your Comment</a>

    <div class="attachments">
    {% for attachment in activity.attachment.all %}
        {% if attachment.is_valid %}
            <div>
                {% if attachment.type == 'video' %}
                    {% youtube_video attachment.url %}
                {% else %}
                <a class="thumbnail" href="{{attachment.file.url}}"><img src="{{attachment.file.url}}"/></a>
                {% endif %}
            </div>
            {% else %}
            <div class="notice">This content is currently unavailable.</div>
            {% endif %}
    {% endfor %}
    </div>

    <input type="hidden" id="dragable" name="dragable" value="false">
    {% for x, lat, lon in init_coords %}
        <input type="hidden" id="init_coords{{x}}" name="init_coords{{x}}" lat="{{lat}}" lon="{{lon}}"/>
    {% endfor %}
    <div id="map" class="google-map" data-type="Point"></div>

    <div id="comments">
        {%include "comments/post.html"%}
        <div style="clear: both;"></div>
    </div>

{%endblock%}


{%block body%}
    <script src="http://maps.google.com/maps/api/js?sensor=false&libraries=places" type="text/javascript"></script>
    <!-- script src="http://maps.google.com/maps/api/js?sensor=true" type="text/javascript" charset="utf-8"></script -->
    <script src="{{MEDIA_URL}}js/games/mapit.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">
        jQuery(function($) {
            $(".google-map").mapit({{map|safe|escape}});
            $(".remove-map").remove();
        });
    </script>
    
    <script>
    $(document).ready(function() {
        try {
            aElem = document.getElementById("my_comment");
            {% if myComment %}
                aElem.href = "#comment-{{myComment.id}}"
            {% endif %}
        } catch(err) {
            alert(err);
        }
    });
    </script>
{%endblock%}