{% extends "base_game.html" %}
{% load i18n cpi_tags %}

{% block title %}Challenges{% endblock %}

{% block content %}
<div class="wrapper">
    
    <div>
        <p>{% trans "By answering challenge questions you are helping plan your community, and you are earning points that move you towards accomplishing the mission." %}</p>
    </div>
    
    <div class="challenges-container box-shadow-container row">
    {% for challenge in challenges %}
        {% with challenge.get_points as points and challenge.completed_count as completed_count and challenge.activity_type_readable as activity_type %}
            {% if mission.is_expired %}
                <div class="challenge {% if challenge.is_trivia %}challenge-trivia{% else %}{{ activity_type }}{% endif %} span3">
                    <a href="{{ challenge.overview_url }}">
                        {{ challenge|trans_fallback:"name" }}
                        ({{ completed_count }} response{{ completed_count|pluralize }})
                    </a>
                </div>
            {% else %}
                {% if mission.is_future %}
                    {# Non-started Mission #}
                    <div class="challenge challenge-inactive {% if challenge.is_trivia %}trivia{% else %}{{ activity_type }}{% endif %} span3">
                        <a>{{ ctivity|trans_fallback:"name" }}</a>
                    </div>
                {% else %}
                    {# Active Mission #}
                    {% if challenge in my_completed %}
                    {#  completed challenge #}
                    <div class="challenge challenge-completed {% if challenge.is_trivia %}challenge-trivia{% else %}{{ activity_type }}{% endif %} span3">
                        <a href="{{ challenge.play_url }}">
                            {{ challenge|trans_fallback:"name" }}
                            ({{ completed_count }} response{{ completed_count|pluralize }})
                        </a>
                    </div>
                    {% else %}
                    {# fresh activity #}
                    <div class="challenge {% if challenge.is_trivia %}challenge-trivia{% else %}{{ activity_type }}{% endif %} span3">
                        <a href="{{ challenge.play_url }}">
                            {{ challenge|trans_fallback:"name" }}
                            ({{ completed_count }} response{{ completed_count|pluralize }})
                        </a>
                    </div>
                    {% endif %}
                {% endif %}
            {% endif %}
        {% endwith %}
    {% empty %}
        {% trans "There are currently no activities for this mission. Check back later." %}
    {% endfor %}
    </div>
</div>


{% endblock content %}