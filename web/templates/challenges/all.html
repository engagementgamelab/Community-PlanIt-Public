{% extends "base_game.html" %}
{% load i18n cpi_tags %}

{% block title %}Challenges{% endblock %}

{% block content %}
<div class="wrapper section-challenges">
    
    <div>
        <p>{% trans "By answering challenge questions you are helping plan your community, and you are earning points that move you towards accomplishing the mission." %}</p>
    </div>
    
    <div class="challenges-container box-shadow-container row">
    {% for challenge in challenges %}
        
        {% with challenge.get_points as points and challenge.completed_count as completed_count and challenge.activity_type_readable as activity_type %}

        {% if mission.is_expired %}
            <div class="challenge {% if challenge.is_trivia %}challenge-trivia{% else %}{{ activity_type }}{% endif %} span3">
                <h2>{{ challenge|trans_fallback:"name" }}</2>
                <div>{{ activity_type }}</div>
                <div><i class="icon-comment"></i> {{ completed_count }}</div>
                <div><a href="{{ challenge.overview_url }}" class="btn btn-primary">Review</a></div>
            </div>
        {% else %}
            {% if mission.is_future %}
                {# Non-started Mission #}
                <div class="challenge challenge-inactive {% if challenge.is_trivia %}trivia{% else %}{{ activity_type }}{% endif %} span3">
                    <h3>{{ challenge|trans_fallback:"name" }}</div>
                    <div>{{ activity_type }}</div>
                    <div><a>{{ ctivity|trans_fallback:"name" }}</a></div>
                </div>
            {% else %}
                {# Active Mission #}
                {% if challenge in my_completed %}
                {#  completed challenge #}
                <div class="challenge challenge-completed {% if challenge.is_trivia %}challenge-trivia{% else %}{{ activity_type }}{% endif %} span3">
                    <h3>{{ challenge|trans_fallback:"name" }}</h3>
                    <div>{{ activity_type }}</div>
                    <div><i class="icon-comment"></i> {{ completed_count }}</div>
                    <div><a href="{{ challenge.overview_url }}" class="btn btn-primary">Review</a></div>
                </div>
                {% else %}
                {# fresh activity #}
                <div class="challenge {% if challenge.is_trivia %}challenge-trivia{% else %}{{ activity_type }}{% endif %} span3">
                    <h3>{{ challenge|trans_fallback:"name" }}</h3>
                    <div>{{ activity_type }}</div>
                    <div><i class="icon-comment"></i> {{ completed_count }}</div>
                    <div><a href="{{ challenge.play_url }}" class="btn btn-primary">View Challenge</a></div>
                </div>
                {% endif %}
            {% endif %}
        {% endif %}
        {% endwith %}
    {% empty %}
        {% trans "There are currently no activities for this mission. Check back later." %}
    {% endfor %}
    </div>
</div>


{% endblock content %}