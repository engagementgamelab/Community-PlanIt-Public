{% extends "challenges/base.html" %}
{% load i18n cpi_tags %}

{% block title %}{{ block.super }} | Challenges for {{ mission.name }}{% endblock %}

{% block content %}

<p>{% trans "By answering challenge questions you are helping plan your community, and you are earning points that move you towards accomplishing the mission." %}</p>

{% if challenges and mission.is_active %}
    {{ my_completed|length }}/{{ challenges|length }} {% trans "challenges completed" %}
{% endif %}


{% for challenge in challenges %}
    {% with challenge.get_points as points and challenge.completed_count as completed_count and challenge.activity_type_readable as activity_type %}
        {% if mission.is_expired %}
            <div class="activity  activity-inactive {% if challenge.is_trivia %}trivia{% else %}{{ activity_type }}{% endif %}">
                <a href="{{ challenge.overview_url }}">
                    {{ challenge|trans_fallback:"name" }}
                    ({{ completed_count }} response{{ completed_count|pluralize }})
                </a>
            </div>
        {% else %}
            {% if mission.is_future %}
                {# Non-started Mission #}
                <div class="activity activity-inactive {% if challenge.is_trivia %}trivia{% else %}{{ activity_type }}{% endif %}">
                    <a>
                    {{ ctivity|trans_fallback:"name" }}
                    </a>
                </div>
            {% else %}
                {# Active Mission #}
                {% if challenge in my_completed %}
                {#  completed challenge #}
                <div class="activity activity-completed {% if challenge.is_trivia %}trivia{% else %}{{ activity_type }}{% endif %}">
                    <a href="{{ challenge.challenge_url }}">
                        {{ challenge|trans_fallback:"name" }}
                        ({{ completed_count }} response{{ completed_count|pluralize }})
                        <div class="mission-activity-completed"></div>
                    </a>
                </div>
                {% else %}
                {# fresh activity #}
                <div class="activity {% if challenge.is_trivia %}trivia{% else %}{{ activity_type }}{% endif %}">
                    <a href="{{ challenge.challenge_url }}">
                        {{ challenge|trans_fallback:"name" }}
                        ({{ completed_count }} response{{ completed_count|pluralize }})
                        <div class="mission-activity-points">{{ points }}</div>
                    </a>
                </div>
                {% endif %}
            {% endif %}
        {% endif %}
    {% endwith %}
{% empty %}
    {% trans "There are currently no activities for this mission. Check back later." %}
{% endfor %}
{% endblock content %}
